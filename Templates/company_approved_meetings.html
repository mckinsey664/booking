{% extends "company_dashboard.html" %}
{% block content %}
<div class="container mt-4">
  <h2>âœ… Approved Meetings Calendar</h2>
  <p class="text-muted">View all your approved meetings below in a calendar format.</p>

  <div id="calendar"></div>
</div>

<!-- âœ… FullCalendar + Bootstrap -->
<link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.10/index.global.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.10/index.global.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<script>
document.addEventListener("DOMContentLoaded", function () {
  const calendarEl = document.getElementById("calendar");

  const calendar = new FullCalendar.Calendar(calendarEl, {
    // âœ… Start directly on Dec 9, 2025 in *day view*
    initialDate: "2025-12-09",
    initialView: "timeGridDay",
    height: "auto",
    themeSystem: "bootstrap5",

    headerToolbar: {
      left: "prev,next today",
      center: "title",
      right: "timeGridDay,timeGridWeek,dayGridMonth"
    },

    // âœ… Limit navigation between Dec 9 and Dec 10, 2025
    validRange: {
      start: "2025-12-09",
      end: "2025-12-11"   // FullCalendar's end is exclusive â†’ allows 9th & 10th
    },
    navLinks: false,      // disable date clicking outside valid range

    events: "{{ url_for('company_approved_meetings', format='json') }}",

    eventColor: "#198754",
    eventDisplay: "block",

    eventDidMount: function(info) {
      // ðŸ’¬ Tooltip with formatted info
      const details = `
        <b>${info.event.title}</b><br>
        <span>ðŸ“… ${new Date(info.event.start).toLocaleDateString()}</span><br>
        <span>ðŸ•’ ${info.event.start.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}
          â†’ ${info.event.end ? info.event.end.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}) : ''}</span>
      `;
      new bootstrap.Tooltip(info.el, {
        title: details,
        placement: "top",
        html: true,
        trigger: "hover",
        container: "body"
      });
    },

    // âœ… Prevent navigation outside valid range
    datesSet: function(view) {
      const current = view.currentStart;
      const min = new Date("2025-12-09");
      const max = new Date("2025-12-11");
      if (current < min || current >= max) {
        calendar.gotoDate("2025-12-09");
      }
    }
  });

  calendar.render();
});
</script>


<style>
#calendar {
  background: #fff;
  border-radius: 10px;
  padding: 15px;
  box-shadow: 0 0 10px rgba(0,0,0,0.1);
}
.fc-toolbar-title {
  font-weight: 600;
}
</style>
{% endblock %}
